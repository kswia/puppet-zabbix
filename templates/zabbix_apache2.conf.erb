<% if @port.to_i != 80 -%>
Listen <%= @port %>
<% end -%>

<VirtualHost *:<%= @port %>>

  ServerName <%= @srvname %>
  DocumentRoot <%= @docroot %>
  ErrorLog <%= @logroot %>/<%= @name %>_error.log
  LogLevel warn
<% if @access_log -%>
  CustomLog <%= @logroot %>/<%= @name %>_access.log combined
<% end -%>
  ServerSignature Off

  <Directory "/usr/share/zabbix">
    Options FollowSymLinks
    AllowOverride None
    Order allow,deny
    Allow from all

    php_value max_execution_time 300
    php_value memory_limit 128M
    php_value post_max_size 16M
    php_value upload_max_filesize 2M
    php_value max_input_time 300
    # php_value date.timezone Europe/Riga
  </Directory>

  <Directory "/usr/share/zabbix/conf">
    Order deny,allow
    Deny from all
    <files *.php>
      Order deny,allow
      Deny from all
    </files>
  </Directory>

  <Directory "/usr/share/zabbix/api">
    Order deny,allow
    Deny from all
    <files *.php>
      Order deny,allow
      Deny from all
    </files>
  </Directory>

  <Directory "/usr/share/zabbix/include">
    Order deny,allow
    Deny from all
    <files *.php>
      Order deny,allow
      Deny from all
    </files>
  </Directory>

  <Directory "/usr/share/zabbix/include/classes">
    Order deny,allow
    Deny from all
    <files *.php>
      Order deny,allow
      Deny from all
    </files>
  </Directory>
</VirtualHost>
